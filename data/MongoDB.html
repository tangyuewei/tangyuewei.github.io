<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MongoDB | 唐悦玮</title>
    <meta name="description" content="努力只是一种生活方式，先敬业，再乐业">
    
    <meta name="keywords" content="唐悦玮,MongoDB,MongoDB学习,MongoDB官网,MongoDB使用指南,MongoDB索引使用">
    <link rel="preload" href="/assets/css/0.styles.49a09e5d.css" as="style"><link rel="preload" href="/assets/js/app.08b72cac.js" as="script"><link rel="preload" href="/assets/js/21.42a22e72.js" as="script"><link rel="prefetch" href="/assets/js/10.14803a23.js"><link rel="prefetch" href="/assets/js/11.4289b726.js"><link rel="prefetch" href="/assets/js/12.1f16ca00.js"><link rel="prefetch" href="/assets/js/13.562ef4f8.js"><link rel="prefetch" href="/assets/js/14.d7919d60.js"><link rel="prefetch" href="/assets/js/15.18554717.js"><link rel="prefetch" href="/assets/js/16.a7a42460.js"><link rel="prefetch" href="/assets/js/17.b65c334c.js"><link rel="prefetch" href="/assets/js/18.8af4cec2.js"><link rel="prefetch" href="/assets/js/19.60feb48e.js"><link rel="prefetch" href="/assets/js/2.4d58626d.js"><link rel="prefetch" href="/assets/js/20.d4ec8f67.js"><link rel="prefetch" href="/assets/js/22.8a4f4238.js"><link rel="prefetch" href="/assets/js/23.eb3d97e8.js"><link rel="prefetch" href="/assets/js/24.ea2cf265.js"><link rel="prefetch" href="/assets/js/25.d7c8740a.js"><link rel="prefetch" href="/assets/js/26.cd62a9e5.js"><link rel="prefetch" href="/assets/js/27.0ac4949f.js"><link rel="prefetch" href="/assets/js/28.2ba2c0c4.js"><link rel="prefetch" href="/assets/js/29.4db4d20d.js"><link rel="prefetch" href="/assets/js/3.4761a21f.js"><link rel="prefetch" href="/assets/js/30.2d01528b.js"><link rel="prefetch" href="/assets/js/31.ec6114b2.js"><link rel="prefetch" href="/assets/js/32.3aa908ad.js"><link rel="prefetch" href="/assets/js/33.d19f8cfb.js"><link rel="prefetch" href="/assets/js/34.3cf937ca.js"><link rel="prefetch" href="/assets/js/35.d7917a11.js"><link rel="prefetch" href="/assets/js/36.620f4839.js"><link rel="prefetch" href="/assets/js/37.8c5d0801.js"><link rel="prefetch" href="/assets/js/38.c8ff2500.js"><link rel="prefetch" href="/assets/js/39.f899679e.js"><link rel="prefetch" href="/assets/js/4.4a046784.js"><link rel="prefetch" href="/assets/js/40.7489618f.js"><link rel="prefetch" href="/assets/js/41.5011af83.js"><link rel="prefetch" href="/assets/js/42.003e4c8a.js"><link rel="prefetch" href="/assets/js/43.e088b09c.js"><link rel="prefetch" href="/assets/js/44.0aecb040.js"><link rel="prefetch" href="/assets/js/45.5a55e548.js"><link rel="prefetch" href="/assets/js/46.64e35459.js"><link rel="prefetch" href="/assets/js/47.0fbbb3cd.js"><link rel="prefetch" href="/assets/js/48.c11df92f.js"><link rel="prefetch" href="/assets/js/49.ef580b58.js"><link rel="prefetch" href="/assets/js/5.905b9bca.js"><link rel="prefetch" href="/assets/js/50.b12a5475.js"><link rel="prefetch" href="/assets/js/51.8451b540.js"><link rel="prefetch" href="/assets/js/52.673a8761.js"><link rel="prefetch" href="/assets/js/53.5434dd90.js"><link rel="prefetch" href="/assets/js/54.4dc8e18e.js"><link rel="prefetch" href="/assets/js/55.9a347483.js"><link rel="prefetch" href="/assets/js/56.892a6ef0.js"><link rel="prefetch" href="/assets/js/57.a5230ba7.js"><link rel="prefetch" href="/assets/js/58.939cd696.js"><link rel="prefetch" href="/assets/js/59.a60202e4.js"><link rel="prefetch" href="/assets/js/6.64b8df3d.js"><link rel="prefetch" href="/assets/js/60.7fcbfaa3.js"><link rel="prefetch" href="/assets/js/61.102cd029.js"><link rel="prefetch" href="/assets/js/62.efcc02f7.js"><link rel="prefetch" href="/assets/js/63.2159b871.js"><link rel="prefetch" href="/assets/js/64.ac9b2006.js"><link rel="prefetch" href="/assets/js/65.cdd61f79.js"><link rel="prefetch" href="/assets/js/66.edfb6058.js"><link rel="prefetch" href="/assets/js/67.75cecf46.js"><link rel="prefetch" href="/assets/js/68.3fb157a5.js"><link rel="prefetch" href="/assets/js/69.e690cdf0.js"><link rel="prefetch" href="/assets/js/7.d70360ae.js"><link rel="prefetch" href="/assets/js/70.9911e034.js"><link rel="prefetch" href="/assets/js/71.65ac58bd.js"><link rel="prefetch" href="/assets/js/72.b9453883.js"><link rel="prefetch" href="/assets/js/73.1590277e.js"><link rel="prefetch" href="/assets/js/74.f6d3cf45.js"><link rel="prefetch" href="/assets/js/75.596e6050.js"><link rel="prefetch" href="/assets/js/76.9847489d.js"><link rel="prefetch" href="/assets/js/77.e60a770f.js"><link rel="prefetch" href="/assets/js/78.211b6c06.js"><link rel="prefetch" href="/assets/js/79.f406f05c.js"><link rel="prefetch" href="/assets/js/8.db366737.js"><link rel="prefetch" href="/assets/js/80.41ef285e.js"><link rel="prefetch" href="/assets/js/81.dd3cd041.js"><link rel="prefetch" href="/assets/js/82.c053d0dd.js"><link rel="prefetch" href="/assets/js/83.6ea003e8.js"><link rel="prefetch" href="/assets/js/84.e09299d3.js"><link rel="prefetch" href="/assets/js/85.3287376f.js"><link rel="prefetch" href="/assets/js/86.193163d8.js"><link rel="prefetch" href="/assets/js/87.05fc0d76.js"><link rel="prefetch" href="/assets/js/88.5651f92c.js"><link rel="prefetch" href="/assets/js/89.6664a12c.js"><link rel="prefetch" href="/assets/js/9.93b8af4c.js"><link rel="prefetch" href="/assets/js/90.4f374e6e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.49a09e5d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">唐悦玮</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/technical/" class="nav-link">技术博客</a></div><div class="nav-item"><a href="/article/" class="nav-link">管理思维</a></div><div class="nav-item"><a href="/micro_service/" class="nav-link">微服务架构</a></div><div class="nav-item"><a href="http://blog.tangyuewei.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客系统
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/technical/" class="nav-link">技术博客</a></div><div class="nav-item"><a href="/article/" class="nav-link">管理思维</a></div><div class="nav-item"><a href="/micro_service/" class="nav-link">微服务架构</a></div><div class="nav-item"><a href="http://blog.tangyuewei.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客系统
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>计算机基础</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Java编程</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>JVM</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Spring Boot</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>软件工程</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>数据</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/data/MySql.html" class="sidebar-link">mysql</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/data/MySql.html#下载安装" class="sidebar-link">下载安装</a></li><li class="sidebar-sub-header"><a href="/data/MySql.html#创建和使用数据库" class="sidebar-link">创建和使用数据库</a></li><li class="sidebar-sub-header"><a href="/data/MySql.html#索引" class="sidebar-link">索引</a></li><li class="sidebar-sub-header"><a href="/data/MySql.html#字段操作" class="sidebar-link">字段操作</a></li><li class="sidebar-sub-header"><a href="/data/MySql.html#优化" class="sidebar-link">优化</a></li><li class="sidebar-sub-header"><a href="/data/MySql.html#缓存清理" class="sidebar-link">缓存清理</a></li></ul></li><li><a href="/data/MongoDB.html" aria-current="page" class="active sidebar-link">MongoDB</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/data/MongoDB.html#概述" class="sidebar-link">概述</a></li><li class="sidebar-sub-header"><a href="/data/MongoDB.html#特点" class="sidebar-link">特点</a></li><li class="sidebar-sub-header"><a href="/data/MongoDB.html#mongodb-crud操作" class="sidebar-link">MongoDB CRUD操作</a></li><li class="sidebar-sub-header"><a href="/data/MongoDB.html#聚合" class="sidebar-link">聚合</a></li><li class="sidebar-sub-header"><a href="/data/MongoDB.html#索引" class="sidebar-link">索引</a></li></ul></li><li><a href="/data/Redis.html" class="sidebar-link">Redis</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/data/Redis.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/data/Redis.html#数据类型" class="sidebar-link">数据类型</a></li><li class="sidebar-sub-header"><a href="/data/Redis.html#持久化" class="sidebar-link">持久化</a></li><li class="sidebar-sub-header"><a href="/data/Redis.html#集群方案" class="sidebar-link">集群方案</a></li><li class="sidebar-sub-header"><a href="/data/Redis.html#缓存雪崩" class="sidebar-link">缓存雪崩</a></li><li class="sidebar-sub-header"><a href="/data/Redis.html#缓存穿透" class="sidebar-link">缓存穿透</a></li><li class="sidebar-sub-header"><a href="/data/Redis.html#缓存与数据库双写时的数据不一致性" class="sidebar-link">缓存与数据库双写时的数据不一致性</a></li></ul></li><li><a href="/data/MemCached.html" class="sidebar-link">MemCached</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/data/MemCached.html#概述" class="sidebar-link">概述</a></li><li class="sidebar-sub-header"><a href="/data/MemCached.html#特点" class="sidebar-link">特点</a></li><li class="sidebar-sub-header"><a href="/data/MemCached.html#memcached-存储命令" class="sidebar-link">Memcached 存储命令</a></li><li class="sidebar-sub-header"><a href="/data/MemCached.html#memcached-查找命令" class="sidebar-link">Memcached 查找命令</a></li><li class="sidebar-sub-header"><a href="/data/MemCached.html#memcached-统计命令" class="sidebar-link">Memcached 统计命令</a></li></ul></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>算法与数据结构</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>分布式系统</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="mongodb"><a href="#mongodb" class="header-anchor">#</a> MongoDB</h1> <h2 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h2> <p><a href="https://docs.mongodb.com/manual/" target="_blank" rel="noopener noreferrer">官网手册<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>MongoDB 是一个基于分布式文件存储的数据库。是由字段和值对组成的数据结构。MongoDB文档类似于JSON对象。字段的值可以包括其他文档，数组和文档数组。</p></blockquote> <h2 id="特点"><a href="#特点" class="header-anchor">#</a> 特点</h2> <h3 id="高性能"><a href="#高性能" class="header-anchor">#</a> 高性能</h3> <p>MongoDB提供高性能数据持久性。</p> <ul><li>对嵌入式数据模型的支持减少了数据库系统的I / O活动。</li> <li>索引支持更快的查询，并且可以包含来自嵌入式文档和数组的键。</li></ul> <h3 id="高可用性"><a href="#高可用性" class="header-anchor">#</a> 高可用性</h3> <p>MongoDB的复制工具称为副本集，它提供：</p> <ul><li>自动故障转移和</li> <li>数据冗余。</li></ul> <h2 id="mongodb-crud操作"><a href="#mongodb-crud操作" class="header-anchor">#</a> MongoDB CRUD操作</h2> <ul><li>插入：</li></ul> <div class="language- extra-class"><pre class="language-text"><code>db.collection.insertOne() 版本3.2中的新功能
db.collection.insertMany() 版本3.2中的新功能
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">提示</p> <p>db.users.insertOne(
{
name: &quot;tboss&quot;,
age: 30
}
)</p></div> <ul><li>查询：</li></ul> <div class="language- extra-class"><pre class="language-text"><code>db.collection.find()
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">提示</p> <p>db.users.find(
{age: { $gt: 18 } },
{name: &quot;tboss&quot; }
).limit(20)</p></div> <ul><li>更新</li></ul> <div class="language- extra-class"><pre class="language-text"><code>db.collection.updateOne() 版本3.2中的新功能
db.collection.updateMany() 版本3.2中的新功能
db.collection.replaceOne() 版本3.2中的新功能
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">提示</p> <p>db.users.updateMany(
{age: { $gt: 18 } },
{$set: { name: &quot;tyw&quot; } }
)</p></div> <ul><li>删除</li></ul> <div class="language- extra-class"><pre class="language-text"><code>db.collection.deleteOne() 版本3.2中的新功能
db.collection.deleteMany() 版本3.2中的新功能
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">提示</p> <p>db.users.deleteMany(
{age: { $gt: 18 } }
)</p></div> <h2 id="聚合"><a href="#聚合" class="header-anchor">#</a> 聚合</h2> <div class="language- extra-class"><pre class="language-text"><code>db.collection.aggregate([
    { $match: { status: 0 } },  //精确匹配
    { $group: { _id: &quot;$cust_id&quot;,total: { $sum: &quot;amount&quot; } } }   //精确匹配
]);
</code></pre></div><h2 id="索引"><a href="#索引" class="header-anchor">#</a> 索引</h2> <ul><li>单个索引</li></ul> <blockquote><p>对于单字段索引和排序操作，索引键的排序顺序（即升序或降序）无关紧要，因为MongoDB可以在任一方向上遍历索引。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>db.collection.createIndex( { name: 1 } )    //单个索引
</code></pre></div><ul><li>复合索引</li></ul> <blockquote><p>对于复合索引和排序操作，索引键的排序顺序（即升序或降序）可以确定索引是否可以支持排序操作。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>db.collection.createIndex({name: 1, age: -1}, {background: true})   //复合索引
</code></pre></div><ul><li>多键索引</li></ul> <blockquote><p>如果索引包含数组值的字段，MongoDB会为数组的每个元素创建单独的索引条目。这些多键索引允许查询通过匹配数组的元素或元素来选择包含数组的文档。如果索引字段包含数组值，MongoDB会自动确定是否创建多键索引; 您不需要显式指定多键类型。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>db.collection.createIndex({&quot;stock.size&quot;: 1 })   //多键索引
</code></pre></div><div class="language-json5 extra-class"><pre class="language-json5"><code><span class="token punctuation">{</span>
  <span class="token property unquoted">_id</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token property unquoted">item</span><span class="token operator">:</span> <span class="token string">&quot;ijk&quot;</span><span class="token punctuation">,</span>
  <span class="token property unquoted">stock</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token property unquoted">size</span><span class="token operator">:</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">,</span> <span class="token property unquoted">color</span><span class="token operator">:</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">,</span> <span class="token property unquoted">quantity</span><span class="token operator">:</span> <span class="token number">15</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token property unquoted">size</span><span class="token operator">:</span> <span class="token string">&quot;L&quot;</span><span class="token punctuation">,</span> <span class="token property unquoted">color</span><span class="token operator">:</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">,</span> <span class="token property unquoted">quantity</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token property unquoted">size</span><span class="token operator">:</span> <span class="token string">&quot;L&quot;</span><span class="token punctuation">,</span> <span class="token property unquoted">color</span><span class="token operator">:</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> <span class="token property unquoted">quantity</span><span class="token operator">:</span> <span class="token number">25</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>文字索引</li></ul> <blockquote><p>支持在集合中搜索字符串内容。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>db.collection.createIndex( { name: &quot;text&quot; } )  //文字索引
db.collection.createIndex( { name: &quot;text&quot;, desc: &quot;text&quot; } )  //文字复合索引
db.collection.createIndex( { &quot;$**&quot;: &quot;text&quot; } )  //通配符文字索引--为包含集合中每个文档的字符串数据的每个字段编制索引
</code></pre></div><ul><li>散列索引</li></ul> <blockquote><p>索引在其范围内具有更随机的值分布，但仅支持相等匹配且不支持基于范围的查询。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>db.collection.createIndex( { _id: &quot;hashed&quot; } )  //散列索引--不支持多键
</code></pre></div><ul><li>唯一索引</li></ul> <blockquote><p>索引的唯一属性会导致MongoDB拒绝索引字段的重复值。除了唯一约束之外，唯一索引在功能上可与其他MongoDB索引互换。</p></blockquote> <ul><li>部分索引(版本3.2中的新功能。)</li></ul> <blockquote><p>部分索引仅索引符合指定过滤器表达式的集合中的文档。通过索引集合中的文档子集，部分索引具有较低的存储要求，并降低了索引创建和维护的性能成本。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>db.collection.createIndex(
   { cuisine: 1, name: 1 },
   { partialFilterExpression: { rating: { $gt: 5 } } }
)
</code></pre></div><ul><li>稀疏索引</li></ul> <blockquote><p>索引的稀疏属性可确保索引仅包含具有索引字段的文档的条目。索引会跳过没有索引字段的文档。您可以将稀疏索引选项与唯一索引选项组合，以拒绝具有字段重复值的文档，但忽略没有索引键的文档。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>db.scores.createIndex( { score: 1 } , { sparse: true } )
</code></pre></div><blockquote><p>如果某些文档中不包含score字段，则直接跳过</p></blockquote> <ul><li>TTL索引</li></ul> <blockquote><p>TTL索引是MongoDB可用于在一定时间后自动从集合中删除文档的特殊索引。</p></blockquote> <div class="tip custom-block"><p class="custom-block-title">提示</p> <p>语法中 name 值为你要创建的索引字段，1 为指定按升序创建索引，如果你想按降序来创建索引指定为 -1 即可。</p></div> <table><thead><tr><th>参数</th> <th style="text-align:center">类型</th> <th>描述</th></tr></thead> <tbody><tr><td>background</td> <td style="text-align:center">Boolean</td> <td>建索引过程会阻塞其它数据库操作，background可指定以后台方式创建索引，即增加 &quot;background&quot; 可选参数。 &quot;background&quot; 默认值为false。</td></tr> <tr><td>unique</td> <td style="text-align:center">Boolean</td> <td>建立的索引是否唯一。指定为true创建唯一索引。默认值为false.</td></tr> <tr><td>name</td> <td style="text-align:center">string</td> <td>索引的名称。如果未指定，MongoDB的通过连接索引的字段名和排序顺序生成一个索引名称。</td></tr> <tr><td>dropDups</td> <td style="text-align:center">Boolean</td> <td>3.0+版本已废弃。在建立唯一索引时是否删除重复记录,指定 true 创建唯一索引。默认值为 false.</td></tr> <tr><td>sparse</td> <td style="text-align:center">Boolean</td> <td>对文档中不存在的字段数据不启用索引；这个参数需要特别注意，如果设置为true的话，在索引字段中不会查询出不包含对应字段的文档.。默认值为 false.</td></tr> <tr><td>expireAfterSeconds</td> <td style="text-align:center">integer</td> <td>指定一个以秒为单位的数值，完成 TTL设定，设定集合的生存时间。</td></tr> <tr><td>v</td> <td style="text-align:center">index version</td> <td>索引的版本号。默认的索引版本取决于mongod创建索引时运行的版本。</td></tr> <tr><td>weights</td> <td style="text-align:center">document</td> <td>索引权重值，数值在 1 到 99,999 之间，表示该索引相对于其他索引字段的得分权重。</td></tr> <tr><td>default_language</td> <td style="text-align:center">string</td> <td>对于文本索引，该参数决定了停用词及词干和词器的规则的列表。 默认为英语</td></tr> <tr><td>language_override</td> <td style="text-align:center">string</td> <td>对于文本索引，该参数指定了包含在文档中的字段名，语言覆盖默认的language，默认值为 language.</td></tr></tbody></table> <h3 id="索引管理"><a href="#索引管理" class="header-anchor">#</a> 索引管理</h3> <ul><li>列出索引</li></ul> <div class="language- extra-class"><pre class="language-text"><code>db.collection.getIndexes()
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>db.getCollectionNames().forEach(function(collection) {
   indexes = db[collection].getIndexes();
   print(&quot;Indexes for &quot; + collection + &quot;:&quot;);
   printjson(indexes);
});
//列出所有索引
</code></pre></div><ul><li>删除索引</li></ul> <div class="language- extra-class"><pre class="language-text"><code>db.collection.dropIndex( { &quot;name&quot;: 1 } );   //删除指定索引
db.collection.dropIndexes();    //删除所有索引
</code></pre></div><ul><li>修改索引</li></ul> <blockquote><p>要修改现有索引，需要删除并重新创建索引。例外是 TTL索引，可以通过<a href="https://docs.mongodb.com/manual/reference/command/collMod/#dbcmd.collMod" target="_blank" rel="noopener noreferrer">collMod<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>命令与<a href="https://docs.mongodb.com/manual/reference/command/collMod/#index" target="_blank" rel="noopener noreferrer">index<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>集合标志一起 修改。</p></blockquote></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2020/3/12 下午3:44:09</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/data/MySql.html" class="prev">
          mysql
        </a></span> <span class="next"><a href="/data/Redis.html">
          Redis
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.08b72cac.js" defer></script><script src="/assets/js/21.42a22e72.js" defer></script>
  </body>
</html>
